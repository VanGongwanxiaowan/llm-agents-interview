https://mp.weixin.qq.com/s?__biz=MzIzMDc2Njc0MQ==&mid=2247485354&idx=1&sn=c61e4b03a0fb76f05a9f80e42a03a8de&chksm=e8af2650dfd8af46c4128256ff9ecf64dadff8c737eab65f56b9626b9d3da3524606763f2bf4&scene=178&cur_album_id=3485098467926441986&search_click_id=#rd


# 图解强化学习——基础概念2 网页总结
## 一、文档基础信息
- **作者**：Afunby
- **发布时间**：2024年04月08日
- **发布地点**：广东
- **内容来源**：基于Ketan Doshi博客专栏，参考李宏毅老师讲稿及《动手学强化学习》，后续拟加入强化学习在大语言模型中的应用
- **核心定位**：作为“图解强化学习——基础概念1”的延续，以简单语言深入讲解强化学习（RL）基础概念，解答12个关键问题

## 二、核心概念与关键问题解答
### （一）回报（Return）：所有时间步的总奖励
1. **定义**：智能体（Agent）在任务期间累积的总奖励，而非单一奖励
2. **计算方式**：采用折扣因子γ对各时间步奖励加权求和，公式为“Return = r₀ +γr₁ + γ²r₂ + ….+ γⁿrₙ”，所得奖励为折扣奖励
    - 作用：避免时间步数过大时累积奖励无限增长（如持续性任务）
    - 折扣因子γ含义：体现对远期利益的态度，γ接近1更关注长期累计奖励，接近0更关注短期奖励
3. **关键特性**
    - 即时奖励比后期奖励更有价值：因γ小于1，后期奖励折扣大于近期奖励
    - 总回报高的奖励更优：Agent需着眼整体回报而非单个奖励，例如国际象棋中，初期低奖励但最终赢比赛的策略，因总回报更高而优于初期高奖励却最终输比赛的策略

### （二）策略（Policy）：定义Agent的行动选择规则
1. **定义**：智能体在特定状态下决定其行动的一系列规则，本质是将特定状态映射到特定行动
2. **直观理解**：类似巨型查找表，给定当前状态后，Agent可在表中查找对应行动；现实问题中因状态和操作过多，需用函数替代查找表实现状态-行动映射
3. **常见策略类型**：随机选择行动、选择高已知奖励行动、探索新状态找优路径、选择安全路线避负面奖励等
4. **两种核心策略形式**
    - 确定性策略：Agent处于特定状态时，始终选择相同固定行动
    - 随机性策略：Agent根据各行动概率改变某状态下的行动选择，如“剪刀石头布”中避免固定招式以防被预测
    - 数学表达：策略是输入状态s下采取动作a的概率函数，确定性策略中某动作概率为1、其余为0，随机性策略输出动作概率分布并采样选行动
5. **Agent获取策略的过程**：初始无有效策略，通过强化学习算法逐步学习有用策略
6. **策略选择目标**：挑选能最大化总回报的策略，需结合“价值”概念比较策略优劣

### （三）价值（Value）：遵循策略的预期总回报
1. **定义**：Agent处于特定状态且选择策略π，从该状态（或“状态-行动”对）出发，始终按策略行动的平均长期回报（或期望回报）
2. **两种价值类型**
    - 状态价值（State Value）：按给定策略π，从给定状态执行行动的预期回报，函数将状态（State）映射到价值
    - 状态-行动价值（Q-Value）：从给定状态采取特定行动后，按策略π执行行动的预期收益，函数将“状态-行动”对映射到价值
3. **Reward、Return、Value的关系**
    - Reward：单个行动的即时奖励（即时快乐）
    - Return：回合结束前所有折扣奖励之和
    - Value：多回合中的期望回报（持久幸福），是Agent对过往经验的存储，体现对未来情景的预期价值，类似人类对长期幸福的评估（如健康饮食虽无即时快乐但有高长期价值）
4. **价值依赖策略的原因**：回报和价值取决于Agent在给定状态的行动，而行动由策略决定，故价值依赖策略。例如随机选行动的策略价值较低，选高奖励行动的策略价值更高

### （四）策略比较与RL问题解决
1. **策略比较方法**：给定两个策略，通过遵循策略评估回报，得到对应状态价值函数或动作价值函数，价值函数越高的策略越优
2. **最优策略（Optimal Policy）**：与所有其他策略相比，能为Agent产生最多奖励的策略
3. **RL问题的解决逻辑**
    - 步骤：将问题结构化为马尔可夫决策过程（MDP）→ 创建Agent → 用RL算法训练Agent找到最优策略
    - 核心：找到最优策略即解决RL问题，Agent后续可按最优策略在任意状态选择行动

## 三、后续内容预告
下一篇文章将讲解强化学习算法的解决方案方法

## 四、参考文献
1. https://www.inping.com/j/1eb82528/
2. https://easyai.tech/ai-definition/cnn/
3. https://towardsdatascience.com/reinforcement-learning-made-simple-part-1-intro-to-basic-concepts-and-terminology-1d2a87aa060
